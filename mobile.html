
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>FIRECalc Mobile</title>
    <script>
        // Redirect desktop users if not forced
        if (window.innerWidth > 768 && new URLSearchParams(window.location.search).get('force') !== 'true') {
            window.location.href = './';
        }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="mobile.css">
    <script type="importmap">
    {
      "imports": {
        "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
        "@google/genai": "https://esm.sh/@google/genai@^1.34.0",
        "react/": "https://esm.sh/react@^19.2.3/",
        "react": "https://esm.sh/react@^19.2.3"
      }
    }
    </script>
</head>
<body class="text-slate-300 bg-[#0B0F19] font-inter selection:bg-blue-500/30">

    <!-- Loading / Auth Screen -->
    <div id="login-screen" class="fixed inset-0 flex flex-col items-center justify-center bg-[#0B0F19] z-[100] px-6">
        <div class="mb-8 relative">
            <div class="w-20 h-20 rounded-2xl bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center shadow-2xl shadow-blue-900/40">
                <i class="fas fa-chart-line text-3xl text-white"></i>
            </div>
        </div>
        <h1 class="text-4xl font-black text-white tracking-tighter mb-2">FIRECalc</h1>
        <p class="text-slate-500 font-bold uppercase tracking-widest text-[10px] mb-12">Retirement Engine</p>
        
        <button id="guest-btn" class="w-full py-4 bg-slate-800/80 border border-white/10 text-white rounded-2xl font-bold uppercase tracking-widest text-xs active:scale-95 transition-all mb-4">
            Initialize Local Session
        </button>
        <p class="text-[9px] text-slate-600">Data stored locally on device.</p>
    </div>

    <!-- Profile Selection Modal -->
    <div id="profile-modal" class="fixed inset-0 bg-black/95 z-[200] hidden backdrop-blur-xl">
        <div class="h-full flex flex-col p-6 pt-16">
            <h2 class="text-2xl font-black text-white mb-1">Select Profile</h2>
            <p class="text-xs text-slate-500 font-bold uppercase tracking-widest mb-8">Starting Configuration</p>
            
            <div class="space-y-4 overflow-y-auto pb-safe">
                <button data-profile="blank" class="w-full p-5 bg-slate-900 border border-white/10 rounded-2xl flex items-center gap-4 active:bg-slate-800 transition-all text-left">
                    <div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center text-slate-400 font-black text-lg border border-slate-700">
                        <i class="fas fa-file"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-white">Blank Canvas</h3>
                        <p class="text-[10px] text-slate-400">Start from scratch</p>
                    </div>
                </button>
                <button data-profile="25" class="w-full p-5 bg-slate-900 border border-white/10 rounded-2xl flex items-center gap-4 active:bg-blue-600/20 transition-all text-left">
                    <div class="w-12 h-12 rounded-full bg-teal-500/20 flex items-center justify-center text-teal-400 font-black text-lg">25</div>
                    <div>
                        <h3 class="font-bold text-white">The Starter</h3>
                        <p class="text-[10px] text-slate-400">Single • Aggressive Growth</p>
                    </div>
                </button>
                <button data-profile="45" class="w-full p-5 bg-slate-900 border border-white/10 rounded-2xl flex items-center gap-4 active:bg-blue-600/20 transition-all text-left">
                    <div class="w-12 h-12 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 font-black text-lg">45</div>
                    <div>
                        <h3 class="font-bold text-white">The Accumulator</h3>
                        <p class="text-[10px] text-slate-400">Couple • Family Expenses</p>
                    </div>
                </button>
                <button data-profile="55" class="w-full p-5 bg-slate-900 border border-white/10 rounded-2xl flex items-center gap-4 active:bg-blue-600/20 transition-all text-left">
                    <div class="w-12 h-12 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-black text-lg">55</div>
                    <div>
                        <h3 class="font-bold text-white">The Retiree</h3>
                        <p class="text-[10px] text-slate-400">Preservation • Drawdown</p>
                    </div>
                </button>
            </div>
            
            <button onclick="document.getElementById('profile-modal').classList.add('hidden')" class="mt-auto w-full py-4 text-slate-500 font-bold text-xs uppercase tracking-widest">Cancel</button>
        </div>
    </div>

    <!-- Advanced Settings Modal (Dynamic Content) -->
    <div id="advanced-modal" class="fixed inset-0 bg-black/90 z-[150] hidden backdrop-blur-md flex items-end">
        <div class="w-full bg-[#1e293b] rounded-t-3xl border-t border-white/10 p-6 pb-safe modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-black text-white">Advanced Settings</h3>
                <button onclick="document.getElementById('advanced-modal').classList.add('hidden')" class="w-8 h-8 bg-white/10 rounded-full flex items-center justify-center text-white"><i class="fas fa-times"></i></button>
            </div>
            <div id="advanced-modal-content" class="space-y-4"></div>
        </div>
    </div>

    <!-- Main App Structure -->
    <div id="app-container" class="hidden flex flex-col h-full bg-[#0B0F19]">
        
        <!-- Sticky Header -->
        <header class="fixed top-0 left-0 right-0 bg-[#0B0F19]/90 backdrop-blur-md border-b border-white/5 z-40 pt-safe transition-all duration-300">
            <div class="h-14 flex items-center justify-between px-4">
                <div id="header-left" class="flex flex-col justify-center">
                    <!-- Injected by JS -->
                </div>
                <div id="header-right" class="text-right flex flex-col justify-center items-end">
                    <!-- Injected by JS -->
                </div>
            </div>
            <!-- Optional Toolbar (e.g. Budget Toggle) -->
            <div id="header-toolbar" class="hidden px-4 pb-3"></div>
        </header>

        <!-- Scrollable Content -->
        <main id="mobile-content" class="flex-grow overflow-y-auto pt-20 pb-28 px-4 space-y-4 scroll-smooth">
            <!-- Dynamic Tab Content -->
        </main>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 bg-[#0B0F19]/95 backdrop-blur-xl border-t border-white/5 pb-safe z-50">
            <div class="flex justify-between items-center h-[60px] px-2">
                <button data-tab="assets" class="nav-item active">
                    <i class="fas fa-wallet text-lg mb-1"></i>
                    <span class="text-[9px] font-black uppercase">Assets</span>
                </button>
                <button data-tab="income" class="nav-item">
                    <i class="fas fa-money-bill-wave text-lg mb-1"></i>
                    <span class="text-[9px] font-black uppercase">Income</span>
                </button>
                <button data-tab="budget" class="nav-item">
                    <i class="fas fa-chart-pie text-lg mb-1"></i>
                    <span class="text-[9px] font-black uppercase">Budget</span>
                </button>
                <button data-tab="config" class="nav-item">
                    <i class="fas fa-sliders-h text-lg mb-1"></i>
                    <span class="text-[9px] font-black uppercase">Config</span>
                </button>
                <button data-tab="aid" class="nav-item">
                    <i class="fas fa-hand-holding-heart text-lg mb-1"></i>
                    <span class="text-[9px] font-black uppercase">Aid</span>
                </button>
                <button data-tab="fire" class="nav-item text-purple-400">
                    <i class="fas fa-stairs text-lg mb-1" style="transform: scaleX(-1);"></i>
                    <span class="text-[9px] font-black uppercase">FIRE</span>
                </button>
            </div>
        </nav>
    </div>

    <!-- Modals Overlay Container -->
    <div id="modal-layer" class="fixed inset-0 z-[150] hidden pointer-events-none">
        <!-- Content injected dynamically -->
    </div>

    <script type="module">
        import "./mobile.js?v=5.0"; 
    </script>
</body>
</html>
